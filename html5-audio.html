<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./stylesheets/styles.css">
    <link rel="stylesheet" href="./stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="./stylesheets/font-awesome.min.css">
    <link rel="stylesheet" href="./stylesheets/element.css">
    <title>HTML5 audio API使用心得</title>
  </head>
  <body>
    <div class="wrapper dairy-w">
      <header class="base-h blog-title">
        <h1>HTML5 audio API使用心得</h1>
        <time>2013/11/1</time>
      </header>
      <section class="base-s blog-s">
        <article class="blog">
          <p>小光棍节还在写这个 真是#注定孤独一生#</p>
          <p>FYP是折腾和HTML5 audio有关系的东西 今天本来想要翻译下audio API为了找一个方法的 但是后来想想 那个方法逻辑很简单 不如自己写 然后也就自己写了</p>但是总要记录下来使用心得吧
        </article>
        <article class="blog">
          <ol class="list">
            <li class="list-item">
              <p><i class="icon-num">1.</i>今天遇到的问题是 总是无法获取audio对象 明明使用了<code>$('audio')</code>了 但是依然无法控制audio的属性</p>
              <p>其实问题是在于 获取audio对象的时候不能用<code>$('audio')</code>而是应该使用<code>document.getElementById(id)</code>今天稍微搜了一下 没有找到原因 但是我记得有人解释过的！所以明天接着找一下~</p>
              <mark>update 2013/11/15</mark>
              <p><i class="icon-num">2.</i>今天简直是##￥%￥#%#￥ 静态的页面没有问题 和后台连起来了以后突然进度条就不能拉动了… 我都解释无能了 对着一个静态一个动态页面 相同的js不同的状态都要跪下啦
                最重要的是完全不明白为什么动态的就是不对
              </p>
              <p>非常简单的进度条拖动问题 两行代码搞定的那种 
                <pre>$processYet.width(toWhere);
GLOBAL.audio.currentTime = percentage*GLOBAL.audio.duration;</pre>
              </p>
              <p>后来发生了最无语的事情… 我先是将<code>GLOBAL.audio</code>换成了<code>document.getElementById('player');</code>就行了！！</p>
              <p>然后检查了一遍 其实在页面加载好的时候 我已经做了<code>GLOBAL.audio = document.getElementById('player');</code>了 所以我就把代码还回来 还是用 <code>GLOBAL.audio</code> 然后尼玛就可以拖动进度条了 简直要咆哮了我</p>
              <p>写audio的时候发现一位<a href="http://www.feelcss.com/">前辈</a></p>
              <mark>update 2013/11/23</mark>
              <p>相同的问题再次出现了，所以先把老的办法试了一下，即替换成<code>document·getElementById('player');</code>的方式，但是这次奇迹没有发生，而且回头看前段时间做的player.html页面，再次不可以拖动了。</p>
              <p>后来在<a href="http://webcache.googleusercontent.com/search?q=cache:YTjbk6P8kcsJ:pervasivecode.blogspot.com/2012/09/currenttime-not-working-with-html5.html+&amp;cd=7&amp;hl=zh-CN&amp;ct=clnk&amp;gl=cn">这里</a>发现了问题所在。无法拖动的根本原因在无法改变audio的currentTime，要改变currentTime需要后台允许一个叫做<a href="http://www.web-polygraph.org/docs/userman/ranges.html">Http Range Requests</a>在stack overflow上有人教了怎么分辨server是不是支持Http Range Requests，详细请看<a href="http://stackoverflow.com/questions/720419/how-can-i-find-out-whether-a-server-supports-the-range-header">这里</a>简单来说就是，先把GET方法改成HEAD请求，然后如果是支持Http Range Requests的server，请求页面后返回的是206，否则就是返回正常的200。</p>
              <p>但是现在即使是后台支持了Http Range Requests，有些歌曲还是不能够拖动，但是有些又都可以，格式也都是mp3的。这个问题还要再看看啊，也许JS也应该做些什么？</p>
            </li>
          </ol>
        </article>
      </section>
      <footer class="base-f">
        <p class="view"><a href="./css-noHeightCenter.html"><i class="icon-circle-arrow-left"></i><span class="words">Prev</span></a></p>
        <p class="view"><a href="./trans_multi-line-padded-text.html"><i class="icon-circle-arrow-right"></i><span class="words">Next</span></a></p>
        <p class="view"><a href="./index.html"><i class="icon-home"></i><span class="words">Home</span></a></p>
      </footer>
      <script src="javascripts/scale.fix.js"></script>
    </div>
  </body>
</html>